#!/usr/bin/env python3
# This file is placed in the Public Domain.
#
# pylint: disable=C,R,W0105


"objects"


import os
import sys
import time


sys.path.insert(0, os.getcwd())


from objx.default import Default
from objx.command import Command, cmnd
from objx.errors  import Errors


import mods.irc


"commands"


def cmd(event):
    event.reply(",".join(Command.cmds))


def dbg(event):
    "raise exception"
    raise Exception("yo!")


"register"


Command.add(cmd)
Command.add(dbg)


"runtime"


def main():
    if os.path.exists("mods"):
        import mods.irc
        mods.irc.init()
        while 1:
            try:
                time.sleep(1.0)
            except (KeyboardInterrupt, EOFError):
                return
    evt = cmnd(" ".join(sys.argv[1:]))
    for line in evt.result:
        print(line)
    Errors.show()

if __name__ == "__main__":
    main()
